# BayesReviewNet

**åŸºäºè´å¶æ–¯ç½‘ç»œçš„è™šå‡è¯„è®ºè¯†åˆ«æ¡†æ¶ï¼ˆå¤šè§†è§’ç‰¹å¾å»ºæ¨¡ï¼‰**

æœ¬é¡¹ç›®é‡‡ç”¨æ¦‚ç‡å›¾æ¨¡å‹ï¼ˆProbabilistic Graphical Modelï¼‰æ–¹æ³•ï¼Œé€šè¿‡è´å¶æ–¯ç½‘ç»œæ•´åˆ**Text + Behavior + Network**å¤šè§†è§’ç‰¹å¾å¯¹è¯„è®ºæ•°æ®è¿›è¡Œå»ºæ¨¡ä¸æ¨æ–­ã€‚

---

## æ ¸å¿ƒäº®ç‚¹

### ğŸ¯ æ–¹æ³•è®ºåˆ›æ–°
- **æ¦‚ç‡å›¾æ¨¡å‹**: ä½¿ç”¨è´å¶æ–¯ç½‘ç»œè¿›è¡Œæ¦‚ç‡æ¨æ–­ï¼Œè€Œéé»‘ç›’åˆ†ç±»å™¨
- **å¤šè§†è§’èåˆ**: ç³»ç»Ÿæ•´åˆæ–‡æœ¬ã€è¡Œä¸ºã€ç½‘ç»œä¸‰ç±»ç‰¹å¾
- **å¼±ç›‘ç£å­¦ä¹ **: åŸºäºå¯å‘å¼è§„åˆ™å’Œå¹³å°ä¿¡å·æ„é€ ç›‘ç£ä¿¡å·
- **å› æœå»ºæ¨¡**: DAGç»“æ„æ˜ç¡®è¡¨è¾¾ç‰¹å¾é—´çš„å› æœå…³ç³»

### ğŸ”¬ æŠ€æœ¯ç‰¹è‰²
- **å®Œå…¨å¯è§£é‡Š**: æ‰€æœ‰ç‰¹å¾éƒ½æ˜¯ç»Ÿè®¡é‡ï¼Œæ— æ·±åº¦å­¦ä¹ é»‘ç›’
- **æ¨¡å—åŒ–è®¾è®¡**: åˆ†å±‚æ¶æ„ï¼Œæ¯å±‚å¯¹åº”è´å¶æ–¯ç½‘ç»œå»ºæ¨¡çš„ä¸åŒé˜¶æ®µ
- **æ•°æ®é©±åŠ¨**: ä½¿ç”¨åˆ†ä½æ•°ç¦»æ•£åŒ–ï¼Œé¿å…å›ºå®šé˜ˆå€¼çš„åŸŸä¾èµ–
- **å¯å¤ç°æ€§**: å®Œæ•´é…ç½®ç®¡ç†ï¼Œå›ºå®šéšæœºç§å­

---

## é¡¹ç›®æ¶æ„

### åˆ†å±‚æ¨¡å—åŒ–è®¾è®¡

```
BayesReviewNet/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ preprocessing/              # ã€ç¬¬1å±‚ã€‘æ•°æ®é¢„å¤„ç†
â”‚   â”‚   â”œâ”€â”€ amazon.py               #   - Amazonæ•°æ®åŠ è½½ä¸æ ‡å‡†åŒ–
â”‚   â”‚   â”œâ”€â”€ yelp.py                 #   - Yelpæ•°æ®åŠ è½½ä¸æ ‡å‡†åŒ–
â”‚   â”‚   â”œâ”€â”€ weak_labeling.py        #   - å¼±ç›‘ç£æ ‡ç­¾æ„é€ 
â”‚   â”‚   â””â”€â”€ common.py               #   - é€šç”¨æ¸…æ´—å‡½æ•°
â”‚   â”‚
â”‚   â”œâ”€â”€ features/                   # ã€ç¬¬2å±‚ã€‘ç‰¹å¾å·¥ç¨‹
â”‚   â”‚   â”œâ”€â”€ text_features.py        #   - æ–‡æœ¬ç»Ÿè®¡ç‰¹å¾
â”‚   â”‚   â”œâ”€â”€ behavior_features.py    #   - ç”¨æˆ·è¡Œä¸ºç‰¹å¾
â”‚   â”‚   â”œâ”€â”€ network_features.py     #   - ç½‘ç»œç»“æ„ç‰¹å¾ï¼ˆé¢„ç•™ï¼‰
â”‚   â”‚   â””â”€â”€ discretize.py           #   - æ•°æ®é©±åŠ¨çš„ç¦»æ•£åŒ–
â”‚   â”‚
â”‚   â”œâ”€â”€ bayes/                      # ã€ç¬¬3å±‚ã€‘è´å¶æ–¯ç½‘ç»œæ ¸å¿ƒ
â”‚   â”‚   â”œâ”€â”€ variables.py            #   - éšæœºå˜é‡å®šä¹‰
â”‚   â”‚   â”œâ”€â”€ structure.py            #   - DAGç»“æ„ï¼ˆå› æœå…³ç³»ï¼‰
â”‚   â”‚   â”œâ”€â”€ cpds.py                 #   - æ¡ä»¶æ¦‚ç‡åˆ†å¸ƒå­¦ä¹ 
â”‚   â”‚   â””â”€â”€ inference.py            #   - è´å¶æ–¯æ¨æ–­
â”‚   â”‚
â”‚   â”œâ”€â”€ evaluation/                 # ã€ç¬¬4å±‚ã€‘è¯„ä¼°
â”‚   â”‚   â””â”€â”€ metrics.py              #   - æ€§èƒ½æŒ‡æ ‡è®¡ç®—
â”‚   â”‚
â”‚   â”œâ”€â”€ utils/                      # å·¥å…·æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ io.py                   #   - æ•°æ®I/O
â”‚   â”‚   â”œâ”€â”€ logging.py              #   - æ—¥å¿—ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ config.py               #   - é…ç½®åŠ è½½
â”‚   â”‚   â””â”€â”€ data_split.py           #   - æ•°æ®åˆ’åˆ†
â”‚   â”‚
â”‚   â””â”€â”€ main.py                     # Pipelineè°ƒåº¦å™¨
â”‚
â”œâ”€â”€ yelp_only_experiment.py         # Yelpå•åŸŸå¯¹ç…§å®éªŒ
â”œâ”€â”€ configs/
â”‚   â””â”€â”€ default.yaml                # é…ç½®æ–‡ä»¶
â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ raw/                        # åŸå§‹æ•°æ®ï¼ˆ.gitignoreï¼‰
â”‚   â”‚   â”œâ”€â”€ amazon/
â”‚   â”‚   â””â”€â”€ yelp/
â”‚   â”œâ”€â”€ processed/                  # å¤„ç†åæ•°æ®
â”‚   â””â”€â”€ experiments/                # å®éªŒç»“æœ
â”‚       â””â”€â”€ yelp_only/
â”œâ”€â”€ requirements.txt
â””â”€â”€ README.md
```

---

## å¤šè§†è§’ç‰¹å¾ä½“ç³»

### ğŸ“ Text ç‰¹å¾ï¼ˆæ–‡æœ¬è§†è§’ï¼‰

åŸºäºæ–‡æœ¬ç»Ÿè®¡å’Œè¯å…¸æ–¹æ³•ï¼Œ**ä¸ä½¿ç”¨æ·±åº¦å­¦ä¹ **ï¼š

| ç‰¹å¾ | è¯´æ˜ | è´å¶æ–¯ç½‘ç»œè§’è‰² |
|------|------|---------------|
| `review_length` | è¯„è®ºå­—ç¬¦æ•° | è§‚æµ‹èŠ‚ç‚¹ |
| `sentiment_score` | æƒ…æ„Ÿå€¾å‘ [-1,1] | è§‚æµ‹èŠ‚ç‚¹ |
| `subjectivity_score` | ä¸»è§‚æ€§ [0,1] | è§‚æµ‹èŠ‚ç‚¹ |
| `exclamation_ratio` | æ„Ÿå¹å·å¯†åº¦ | è¾…åŠ©ç‰¹å¾ |
| `first_person_pronoun_ratio` | ç¬¬ä¸€äººç§°ä»£è¯æ¯”ä¾‹ | è¾…åŠ©ç‰¹å¾ |
| `word_count` | è¯æ•° | è¾…åŠ©ç‰¹å¾ |
| `unique_word_ratio` | å”¯ä¸€è¯æ¯”ä¾‹ | è¾…åŠ©ç‰¹å¾ |

**æå–å·¥å…·**: TextBlob (æƒ…æ„Ÿåˆ†æ)ï¼Œæ­£åˆ™è¡¨è¾¾å¼ï¼ˆç»Ÿè®¡ç‰¹å¾ï¼‰

---

### ğŸ‘¤ Behavior ç‰¹å¾ï¼ˆè¡Œä¸ºè§†è§’ï¼‰

åŸºäºç”¨æˆ·å†å²è¡Œä¸ºçš„èšåˆç»Ÿè®¡ç‰¹å¾ï¼š

| ç‰¹å¾ | è¯´æ˜ | è´å¶æ–¯ç½‘ç»œè§’è‰² |
|------|------|---------------|
| `user_review_count` | ç”¨æˆ·è¯„è®ºæ€»æ•° | è§‚æµ‹èŠ‚ç‚¹ |
| `user_rating_deviation` | è¯„åˆ†åå·®ï¼ˆç›¸å¯¹å…¨å±€å‡å€¼ï¼‰ | è§‚æµ‹èŠ‚ç‚¹ |
| `user_rating_entropy` | è¯„åˆ†å¤šæ ·æ€§ï¼ˆç†µï¼‰ | è§‚æµ‹èŠ‚ç‚¹ |
| `user_review_burstiness` | è¯„è®ºæ—¶é—´é›†ä¸­åº¦ | è§‚æµ‹èŠ‚ç‚¹ |
| `user_avg_rating` | ç”¨æˆ·å¹³å‡è¯„åˆ† | è¾…åŠ©ç‰¹å¾ |
| `user_rating_std` | è¯„åˆ†æ ‡å‡†å·® | è¾…åŠ©ç‰¹å¾ |

**è®¡ç®—æ–¹æ³•**: ç”¨æˆ·çº§èšåˆ â†’ å›å¡«åˆ°è¯„è®ºçº§

---

### ğŸ•¸ï¸ Network ç‰¹å¾ï¼ˆç½‘ç»œè§†è§’ï¼‰

åŸºäºç”¨æˆ·-å•†å“äºŒåˆ†å›¾ç»“æ„ï¼ˆé¢„ç•™æ‰©å±•ï¼‰ï¼š

- ç”¨æˆ·åº¦ï¼ˆè¯„è®ºçš„å•†å“æ•°ï¼‰
- å•†å“åº¦ï¼ˆæ”¶åˆ°çš„è¯„è®ºæ•°ï¼‰
- å…±åŒè¯„è®ºè€…æ•°
- PageRank / HITS ç­‰å›¾æŒ‡æ ‡

---

## æ–¹æ³•æµç¨‹

### é˜¶æ®µ1: æ•°æ®é¢„å¤„ç†

```python
ã€èŒè´£ã€‘: åŠ è½½åŸå§‹æ•°æ®å¹¶æ ‡å‡†åŒ–å­—æ®µæ ¼å¼

è¾“å…¥: JSON/CSV åŸå§‹æ•°æ®
å¤„ç†:
  - å­—æ®µæ˜ å°„ç»Ÿä¸€ (reviewerID â†’ user_id)
  - æ—¶é—´æˆ³æ ‡å‡†åŒ–
  - æ–‡æœ¬æ¸…æ´—ï¼ˆå»æ§åˆ¶å­—ç¬¦ã€å¤šä½™ç©ºæ ¼ï¼‰
è¾“å‡º: æ ‡å‡†åŒ– DataFrame

åŸåˆ™:
  âœ… åªåšæ ¼å¼ç»Ÿä¸€
  âŒ ä¸è®¡ç®—ç‰¹å¾
  âŒ ä¸æ„é€ æ ‡ç­¾
```

**æ”¯æŒçš„æ•°æ®é›†**:
- Amazon Reviews 5-core
- Yelp Open Dataset

---

### é˜¶æ®µ2: ç‰¹å¾å·¥ç¨‹

```python
ã€èŒè´£ã€‘: æå–å¤šè§†è§’ç‰¹å¾å¹¶ç¦»æ•£åŒ–

æ­¥éª¤:
  1. æ–‡æœ¬ç‰¹å¾æå– (TextFeatureExtractor)
     â†’ review_length, sentiment_score, ...
  
  2. è¡Œä¸ºç‰¹å¾èšåˆ (BehaviorFeatureExtractor)
     â†’ user_review_count, user_rating_deviation, ...
  
  3. æ•°æ®é©±åŠ¨ç¦»æ•£åŒ– (FeatureDiscretizer)
     â†’ LOW / MEDIUM / HIGH (åŸºäºåˆ†ä½æ•°)

åŸåˆ™:
  âœ… æ‰€æœ‰ç‰¹å¾å¯è§£é‡Š
  âœ… ä½¿ç”¨ pandas.qcut åˆ†ä½æ•°ç¦»æ•£åŒ–
  âŒ ç¦æ­¢æ·±åº¦å­¦ä¹  / embedding
  âŒ ç¦æ­¢å›ºå®šé˜ˆå€¼ï¼ˆé¿å…åŸŸä¾èµ–ï¼‰
```

**ç¦»æ•£åŒ–ç­–ç•¥**:
- ä½¿ç”¨ `pandas.qcut` ä¸‰åˆ†ä½æˆ–å››åˆ†ä½
- æ¯ä¸ªæ•°æ®é›†å†…éƒ¨ç‹¬ç«‹ç¦»æ•£åŒ–
- ç¡®ä¿å„çŠ¶æ€æ ·æœ¬é‡è¿‘ä¼¼ç›¸ç­‰

---

### é˜¶æ®µ3: å¼±æ ‡ç­¾æ„é€ 

```python
ã€èŒè´£ã€‘: åŸºäºå¯å‘å¼è§„åˆ™æ„é€ ç›‘ç£ä¿¡å·

Amazon ç­–ç•¥:
  è§„åˆ™1: æœªéªŒè¯è´­ä¹° (verified=False) â†’ +1åˆ†
  è§„åˆ™2: æç«¯è¯„åˆ† (1æ˜Ÿæˆ–5æ˜Ÿ) â†’ +1åˆ†
  è§„åˆ™3: è¯„è®ºé•¿åº¦å¼‚å¸¸ â†’ +1åˆ†
  è§„åˆ™4: ç”¨æˆ·è¯„è®ºæ•°å¼‚å¸¸ â†’ +1åˆ†
  è§„åˆ™5: è¯„åˆ†åå·®å¤§ â†’ +1åˆ†
  
  åˆ¤å®š: suspicion_score >= 3 â†’ Fraud (1)

Yelp ç­–ç•¥:
  - ä¼˜å…ˆä½¿ç”¨å¹³å° filtered æ ‡ç­¾
  - åå¤‡ä½¿ç”¨å¯å‘å¼è§„åˆ™

è¾“å‡º: weak_label âˆˆ {0, 1}
```

**é‡è¦**: å¼±æ ‡ç­¾æ˜¯**å˜ˆæ‚çš„ä»£ç†æ ‡ç­¾**ï¼Œä¸æ˜¯çœŸå®æ ‡æ³¨

---

### é˜¶æ®µ4: è´å¶æ–¯ç½‘ç»œå»ºæ¨¡

#### 4.1 å˜é‡å®šä¹‰ (`variables.py`)

```python
# ç¤ºä¾‹ï¼šå®šä¹‰éšæœºå˜é‡
REVIEW_LENGTH = BayesianVariable(
    name='review_length_discrete',
    states=['SHORT', 'MEDIUM', 'LONG'],
    variable_type='text_feature'
)

USER_REVIEW_COUNT = BayesianVariable(
    name='user_review_count_discrete',
    states=['LOW', 'MEDIUM', 'HIGH'],
    variable_type='behavior_feature'
)

WEAK_LABEL = BayesianVariable(
    name='weak_label',
    states=[0, 1],  # 0=Normal, 1=Fraud
    variable_type='target'
)
```

---

#### 4.2 DAG ç»“æ„å®šä¹‰ (`structure.py`)

**é»˜è®¤ç»“æ„ï¼ˆDefaultï¼‰**: å¤šè§†è§’ç‰¹å¾èåˆ

```
          Platform
              â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â†“                     â†“
Text Features      Behavior Features
    â†“                     â†“
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ weak_label â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ç®€åŒ–ç»“æ„ï¼ˆNaiveï¼‰**: ç‰¹å¾æ¡ä»¶ç‹¬ç«‹

```
Text Features â”€â”€â†’ weak_label â†â”€â”€ Behavior Features
(æ¡ä»¶ç‹¬ç«‹å‡è®¾)
```

**ä»£ç ç¤ºä¾‹**:
```python
edges = [
    # Platform prior
    ('platform', 'weak_label'),
    
    # Text features â†’ weak_label
    ('review_length_discrete', 'weak_label'),
    ('sentiment_score_discrete', 'weak_label'),
    ('subjectivity_score_discrete', 'weak_label'),
    
    # Behavior features â†’ weak_label
    ('user_review_count_discrete', 'weak_label'),
    ('user_rating_deviation_discrete', 'weak_label'),
    ('user_rating_entropy_discrete', 'weak_label'),
    ('user_review_burstiness_discrete', 'weak_label'),
]
```

---

#### 4.3 CPD å­¦ä¹  (`cpds.py`)

**æ¡ä»¶æ¦‚ç‡åˆ†å¸ƒå­¦ä¹ **:

```python
P(weak_label | parents) = ä»è®­ç»ƒæ•°æ®ä¸­ç»Ÿè®¡
                        + Laplace å¹³æ»‘ (Î±=1.0)

ç¤ºä¾‹:
  P(weak_label=1 | review_length=SHORT, user_count=HIGH) 
  = (count + Î±) / (total + Î± Ã— |states|)
```

**å¤„ç†ç¼ºå¤±å€¼**:
- å°† NaN æ˜ å°„ä¸ºç‰¹æ®ŠçŠ¶æ€ `'MISSING'`
- ä½œä¸ºåˆæ³•çŠ¶æ€å‚ä¸ CPD å­¦ä¹ 

---

#### 4.4 è´å¶æ–¯æ¨æ–­ (`inference.py`)

**åéªŒæ¦‚ç‡è®¡ç®—**:

```python
P(weak_label=1 | evidence) = 
    P(weak_label=1) Ã— âˆ P(feature_i | weak_label=1) / Z

å…¶ä¸­:
  - P(weak_label=1): å…ˆéªŒæ¦‚ç‡
  - P(feature_i | weak_label=1): ä¼¼ç„¶
  - Z: å½’ä¸€åŒ–å¸¸æ•°
```

**è¾“å‡º**: æ¯ä¸ªæ ·æœ¬çš„åéªŒæ¦‚ç‡ï¼Œ**ä¸åšäºŒå€¼åˆ†ç±»**

---

### é˜¶æ®µ5: è¯„ä¼°

```python
ã€èŒè´£ã€‘: è®¡ç®—æ€§èƒ½æŒ‡æ ‡

æŒ‡æ ‡:
  - Precision / Recall / F1-Score
  - ROC-AUC
  - æœ€ä¼˜é˜ˆå€¼é€‰æ‹©ï¼ˆåŸºäºéªŒè¯é›†ï¼‰

åŸåˆ™:
  âœ… æ¨æ–­å’Œåˆ†ç±»åˆ†ç¦»
  âœ… é˜ˆå€¼åœ¨éªŒè¯é›†ä¸Šé€‰æ‹©
  âœ… æµ‹è¯•é›†ä»…ç”¨äºæœ€ç»ˆè¯„ä¼°
```

---

## å¿«é€Ÿå¼€å§‹

### 1. ç¯å¢ƒé…ç½®

```bash
# å®‰è£…ä¾èµ–
pip install -r requirements.txt

# ä¸‹è½½ NLTK æ•°æ®ï¼ˆé¦–æ¬¡è¿è¡Œï¼‰
python -c "import nltk; nltk.download('punkt')"
```

**ä¾èµ–åº“**:
- `pandas`, `numpy`: æ•°æ®å¤„ç†
- `scipy`: ç†µè®¡ç®—
- `textblob`: æƒ…æ„Ÿåˆ†æ
- `scikit-learn`: è¯„ä¼°æŒ‡æ ‡
- `pyyaml`: é…ç½®ç®¡ç†
- `fastparquet`: é«˜æ•ˆæ•°æ®å­˜å‚¨

**ä¸ä¾èµ–**: `torch`, `tensorflow`, `transformers` ç­‰æ·±åº¦å­¦ä¹ åº“

---

### 2. å‡†å¤‡æ•°æ®

```bash
# æ•°æ®ç›®å½•ç»“æ„
data/
â”œâ”€â”€ raw/
â”‚   â”œâ”€â”€ amazon/
â”‚   â”‚   â”œâ”€â”€ Gift_Cards_5.json
â”‚   â”‚   â”œâ”€â”€ Digital_Music_5.json
â”‚   â”‚   â””â”€â”€ ...
â”‚   â””â”€â”€ yelp/
â”‚       â””â”€â”€ yelp_academic_dataset_review.json
```

**æ•°æ®æ¥æº**:
- Amazon: https://nijianmo.github.io/amazon/index.html
- Yelp: https://www.yelp.com/dataset

---

### 3. è¿è¡Œå®éªŒ

#### æ–¹å¼1: å•æ•°æ®é›†å®éªŒ

```bash
# å¤„ç† Amazon æ•°æ®é›†
python src/main.py --datasets amazon

# å¤„ç† Yelp æ•°æ®é›†
python src/main.py --datasets yelp

# å¤„ç†æ‰€æœ‰æ•°æ®é›†
python src/main.py --datasets all
```

#### æ–¹å¼2: Yelp å•åŸŸå¯¹ç…§å®éªŒï¼ˆæ¨èï¼‰

```bash
# å¿«é€Ÿæµ‹è¯•ï¼ˆ10Kæ ·æœ¬ï¼‰
python yelp_only_experiment.py --sample-size 10000

# ä¸­ç­‰è§„æ¨¡å®éªŒï¼ˆ50Kæ ·æœ¬ï¼‰
python yelp_only_experiment.py --sample-size 50000

# å®Œæ•´å®éªŒï¼ˆå…¨é‡æ•°æ®ï¼‰
python yelp_only_experiment.py --no-sampling
```

**è¾“å‡º**:
```
data/experiments/yelp_only/
â”œâ”€â”€ train.parquet          # è®­ç»ƒé›† (70%)
â”œâ”€â”€ validation.parquet     # éªŒè¯é›† (15%)
â”œâ”€â”€ test.parquet          # æµ‹è¯•é›† (15%)
â””â”€â”€ results.json          # æ€§èƒ½æŒ‡æ ‡
```

---

### 4. è‡ªå®šä¹‰é…ç½®

ç¼–è¾‘ `configs/default.yaml`:

```yaml
# æ•°æ®è·¯å¾„
data_paths:
  amazon:
    raw_dir: "data/raw/amazon"
    processed_dir: "data/processed/amazon"
  yelp:
    raw_dir: "data/raw/yelp"
    processed_dir: "data/processed/yelp"

# é‡‡æ ·é…ç½®ï¼ˆç”¨äºå¿«é€Ÿæµ‹è¯•ï¼‰
sampling:
  enabled: true
  amazon_sample_size: 50000
  yelp_sample_size: 5000

# æ—¥å¿—è¾“å‡º
output:
  logs_dir: "logs"
```

---

## å®éªŒç±»å‹

### å®éªŒ1: å•æ•°æ®é›†å»ºæ¨¡

**ç›®çš„**: è¯„ä¼° BayesReviewNet åœ¨å•åŸŸå†…çš„æ€§èƒ½

```bash
python yelp_only_experiment.py --sample-size 50000
```

**è¾“å‡ºç¤ºä¾‹**:
```
ã€æ¨¡å‹æ€§èƒ½ã€‘
  éªŒè¯é›†:
    precision   : 0.6543
    recall      : 0.7823
    f1          : 0.7123
    roc_auc     : 0.8456
  
  æµ‹è¯•é›†:
    precision   : 0.6421
    recall      : 0.7756
    f1          : 0.7026
    roc_auc     : 0.8389

ã€æ³›åŒ–èƒ½åŠ›ã€‘
  Val F1 - Test F1 = +0.0097 (è‰¯å¥½)
```

---

### å®éªŒ2: DAG ç»“æ„å¯¹æ¯”

**ç›®çš„**: æ¯”è¾ƒä¸åŒç½‘ç»œç»“æ„çš„æ€§èƒ½

```bash
# Naive Bayes ç»“æ„ï¼ˆç‰¹å¾æ¡ä»¶ç‹¬ç«‹ï¼‰
python src/main.py --datasets yelp --structure naive

# Default ç»“æ„ï¼ˆç‰¹å¾ä¾èµ–å…³ç³»ï¼‰
python src/main.py --datasets yelp --structure default
```

---

### å®éªŒ3: ç‰¹å¾æ¶ˆèç ”ç©¶

**ç›®çš„**: è¯„ä¼°å„ç‰¹å¾è§†è§’çš„è´¡çŒ®

ä¿®æ”¹ `src/bayes/structure.py`ï¼Œé€ä¸ªç§»é™¤ç‰¹å¾ç±»åˆ«ï¼š
1. ä»… Text ç‰¹å¾
2. ä»… Behavior ç‰¹å¾
3. Text + Behavior

---

## æ€§èƒ½ä¼˜åŒ–å»ºè®®

### æ•°æ®é‡‡æ ·ç­–ç•¥

| é‡‡æ ·å¤§å° | é¢„è®¡æ—¶é—´ | å†…å­˜éœ€æ±‚ | æ¨èç”¨é€” |
|---------|---------|---------|---------|
| 1,000 | 1-2åˆ†é’Ÿ | <1GB | è°ƒè¯•ä»£ç  |
| 10,000 | 5-10åˆ†é’Ÿ | ~2GB | å¿«é€ŸéªŒè¯ |
| 50,000 | 30-60åˆ†é’Ÿ | ~5GB | åˆæ­¥å®éªŒ |
| å…¨é‡ | 2-4å°æ—¶ | 10-20GB | æœ€ç»ˆç»“æœ |

### å»ºè®®å·¥ä½œæµç¨‹

```bash
# æ­¥éª¤1: å¿«é€Ÿè°ƒè¯•
python yelp_only_experiment.py --sample-size 1000

# æ­¥éª¤2: éªŒè¯æµç¨‹
python yelp_only_experiment.py --sample-size 10000

# æ­¥éª¤3: åˆæ­¥è¯„ä¼°
python yelp_only_experiment.py --sample-size 50000

# æ­¥éª¤4: æœ€ç»ˆå®éªŒï¼ˆå›ºå®šç§å­ç¡®ä¿å¯é‡å¤ï¼‰
python yelp_only_experiment.py --no-sampling --seed 42
```

---

## ç ”ç©¶ä»·å€¼

### è®ºæ–‡æ˜ å°„å…³ç³»

æœ¬é¡¹ç›®çš„ä»£ç ç»“æ„ç›´æ¥å¯¹åº”è®ºæ–‡å„ç« èŠ‚ï¼š

| ä»£ç æ¨¡å— | è®ºæ–‡ç« èŠ‚ | å†…å®¹ |
|---------|---------|------|
| `preprocessing/` | 3.1 æ•°æ®é¢„å¤„ç† | æ•°æ®é›†æè¿°ã€æ ‡å‡†åŒ–æµç¨‹ |
| `features/` | 3.2 ç‰¹å¾å·¥ç¨‹ | å¤šè§†è§’ç‰¹å¾è®¾è®¡ä¸æå– |
| `bayes/variables.py` | 3.3.1 å˜é‡å®šä¹‰ | éšæœºå˜é‡åŠå–å€¼ç©ºé—´ |
| `bayes/structure.py` | 3.3.2 ç½‘ç»œç»“æ„ | DAGè®¾è®¡ä¸å› æœå‡è®¾ |
| `bayes/cpds.py` | 3.3.3 å‚æ•°å­¦ä¹  | CPDä¼°è®¡ä¸å¹³æ»‘ |
| `bayes/inference.py` | 3.3.4 æ¦‚ç‡æ¨æ–­ | åéªŒæ¦‚ç‡è®¡ç®— |
| `evaluation/` | 4. å®éªŒç»“æœ | æ€§èƒ½æŒ‡æ ‡ä¸åˆ†æ |

---

### æ–¹æ³•è®ºè´¡çŒ®

1. **å¤šè§†è§’ç‰¹å¾èåˆ**
   - ç³»ç»Ÿæ•´åˆ Text + Behavior + Network ä¸‰ç±»ç‰¹å¾
   - é€šè¿‡ DAG ç»“æ„è¡¨è¾¾ç‰¹å¾é—´å…³ç³»

2. **æ¦‚ç‡æ¨æ–­æ¡†æ¶**
   - è¾“å‡ºåéªŒæ¦‚ç‡ï¼Œè€Œéç¡¬åˆ†ç±»
   - æ”¯æŒä¸ç¡®å®šæ€§é‡åŒ–

3. **å¼±ç›‘ç£å­¦ä¹ **
   - æ— éœ€å¤§è§„æ¨¡äººå·¥æ ‡æ³¨
   - åŸºäºå¯å‘å¼è§„åˆ™å’Œå¹³å°ä¿¡å·

4. **å¯è§£é‡Šæ€§**
   - æ‰€æœ‰ç‰¹å¾éƒ½æ˜¯ç»Ÿè®¡é‡
   - DAG ç»“æ„åæ˜ å› æœå‡è®¾
   - æ”¯æŒ Markov Blanket è§£é‡Š

---

### å¯æ‰©å±•æ€§

#### æ·»åŠ æ–°æ•°æ®é›†

1. åœ¨ `src/preprocessing/` åˆ›å»ºé¢„å¤„ç†å™¨
2. ç»§æ‰¿æ ‡å‡†æ¥å£ï¼Œè¾“å‡ºæ ‡å‡†æ ¼å¼
3. åœ¨ `configs/default.yaml` æ·»åŠ é…ç½®

#### æ·»åŠ æ–°ç‰¹å¾

1. åœ¨ `src/features/` å®ç°ç‰¹å¾æå–å™¨
2. åœ¨ `src/bayes/variables.py` å®šä¹‰å˜é‡
3. åœ¨ `src/bayes/structure.py` æ·»åŠ è¾¹

#### å®éªŒæ–°ç»“æ„

1. åœ¨ `src/bayes/structure.py` å®šä¹‰æ–° DAG
2. è¿è¡Œæ—¶æŒ‡å®š `--structure xxx`

---

## å¸¸è§é—®é¢˜

### Q1: ä¸ºä»€ä¹ˆä¸ä½¿ç”¨æ·±åº¦å­¦ä¹ ï¼Ÿ

**A**: æœ¬é¡¹ç›®ä¸“æ³¨äº**æ¦‚ç‡å›¾æ¨¡å‹æ–¹æ³•è®º**å’Œ**å¯è§£é‡Šæ€§**ï¼š
- âœ… è´å¶æ–¯ç½‘ç»œï¼šæ¦‚ç‡æ¨æ–­ï¼Œæ˜ç¡®å› æœå…³ç³»
- âœ… ç»Ÿè®¡ç‰¹å¾ï¼šå®Œå…¨å¯è§£é‡Š
- âœ… ç ”ç©¶ä»·å€¼ï¼šæ–¹æ³•è®ºåˆ›æ–°ï¼Œè€Œéæ€§èƒ½åˆ·æ¦œ

æ·±åº¦å­¦ä¹ æ˜¯é»‘ç›’æ¨¡å‹ï¼Œæ— æ³•æä¾›æ¦‚ç‡è§£é‡Šå’Œå› æœåˆ†æã€‚

---

### Q2: å¼±æ ‡ç­¾çš„å™ªå£°å¦‚ä½•å¤„ç†ï¼Ÿ

**A**: 
1. **å¤šä¿¡å·èåˆ**: ä½¿ç”¨å¤šä¸ªå¯å‘å¼è§„åˆ™ç»¼åˆåˆ¤å®š
2. **æ¦‚ç‡æ¡†æ¶**: è´å¶æ–¯ç½‘ç»œå¤©ç„¶å¤„ç†ä¸ç¡®å®šæ€§
3. **æ€§èƒ½æœŸæœ›**: ä¸è¿½æ±‚100%å‡†ç¡®ç‡ï¼Œå…³æ³¨ç›¸å¯¹æå‡

---

### Q3: å¦‚ä½•ç¡®ä¿å®éªŒå¯é‡å¤ï¼Ÿ

**A**:
1. **å›ºå®šéšæœºç§å­**: `--seed 42`
2. **å®Œæ•´é…ç½®ç®¡ç†**: `configs/default.yaml`
3. **ç‰ˆæœ¬æ§åˆ¶**: Git è·Ÿè¸ªæ‰€æœ‰ä»£ç å’Œé…ç½®
4. **æ•°æ®åˆ’åˆ†ä¿å­˜**: è®­ç»ƒ/éªŒè¯/æµ‹è¯•é›†åˆ†ç¦»

---

### Q4: æ€§èƒ½å¦‚ä½•æå‡ï¼Ÿ

**A**:
1. **ç‰¹å¾å·¥ç¨‹**: æ·»åŠ æ–°çš„ç»Ÿè®¡ç‰¹å¾
2. **DAG ä¼˜åŒ–**: å®éªŒä¸åŒçš„ç½‘ç»œç»“æ„
3. **å¼±æ ‡ç­¾æ”¹è¿›**: ä¼˜åŒ–å¯å‘å¼è§„åˆ™
4. **æ•°æ®è´¨é‡**: è¿‡æ»¤ä½è´¨é‡æ ·æœ¬

---

### Q5: å¦‚ä½•å¤„ç†å¤§è§„æ¨¡æ•°æ®ï¼Ÿ

**A**:
1. **é‡‡æ ·**: ä½¿ç”¨ `--sample-size` å‚æ•°
2. **åˆ†æ‰¹å¤„ç†**: é€ä¸ªæ•°æ®é›†å¤„ç†
3. **Parquet æ ¼å¼**: é«˜æ•ˆå­˜å‚¨å’Œè¯»å–
4. **å¢é‡å­¦ä¹ **: æœªæ¥å¯æ‰©å±•åœ¨çº¿å­¦ä¹ 

---

## æŠ€æœ¯æ ˆ

| ç»„ä»¶ | æŠ€æœ¯é€‰å‹ | è¯´æ˜ |
|------|---------|------|
| æ•°æ®å¤„ç† | pandas, numpy | é«˜æ•ˆçš„è¡¨æ ¼æ•°æ®æ“ä½œ |
| ç‰¹å¾æå– | textblob, scipy | æ–‡æœ¬åˆ†æä¸ç»Ÿè®¡è®¡ç®— |
| å›¾æ¨¡å‹ | networkx | DAG ç»“æ„ç®¡ç†ï¼ˆæœªæ¥å¯ç”¨äºç½‘ç»œç‰¹å¾ï¼‰ |
| è¯„ä¼° | scikit-learn | æ ‡å‡†è¯„ä¼°æŒ‡æ ‡ |
| é…ç½®ç®¡ç† | PyYAML | äººç±»å¯è¯»çš„é…ç½®æ ¼å¼ |
| æ•°æ®å­˜å‚¨ | fastparquet | é«˜æ•ˆçš„åˆ—å¼å­˜å‚¨ |

**é‡è¦**: å®Œå…¨ä¸ä¾èµ–æ·±åº¦å­¦ä¹ æ¡†æ¶

---

## é¡¹ç›®çŠ¶æ€

âœ… **å·²å®Œæˆ**:
- [x] å¤šè§†è§’ç‰¹å¾æå–ï¼ˆText + Behaviorï¼‰
- [x] æ•°æ®é©±åŠ¨çš„ç¦»æ•£åŒ–
- [x] å¼±ç›‘ç£æ ‡ç­¾æ„é€ 
- [x] è´å¶æ–¯ç½‘ç»œå»ºæ¨¡ï¼ˆCPDå­¦ä¹  + æ¨æ–­ï¼‰
- [x] å•åŸŸå®éªŒæ¡†æ¶
- [x] å®Œæ•´è¯„ä¼°ä½“ç³»

ğŸš§ **è¿›è¡Œä¸­**:
- [ ] Network ç‰¹å¾æå–ï¼ˆç”¨æˆ·-å•†å“å›¾ï¼‰
- [ ] æ›´å¤š DAG ç»“æ„æ¢ç´¢

ğŸ“‹ **æœªæ¥è®¡åˆ’**:
- [ ] åœ¨çº¿å­¦ä¹ æ”¯æŒ
- [ ] å¢é‡æ›´æ–°
- [ ] å¯è§†åŒ–å·¥å…·

---

## è®¸å¯è¯

æœ¬é¡¹ç›®ä»…ç”¨äºå­¦æœ¯ç ”ç©¶ã€‚

---

## å¼•ç”¨

å¦‚æœæœ¬é¡¹ç›®å¯¹æ‚¨çš„ç ”ç©¶æœ‰å¸®åŠ©ï¼Œè¯·å¼•ç”¨ç›¸å…³æ•°æ®é›†ï¼š

```bibtex
@inproceedings{mcauley2016ups,
  title={Ups and downs: Modeling the visual evolution of fashion trends with one-class collaborative filtering},
  author={McAuley, Julian and Targett, Christopher and Shi, Qinfeng and Van Den Hengel, Anton},
  booktitle={WWW},
  year={2016}
}
```

**æ•°æ®æ¥æº**:
- Amazon Reviews: https://nijianmo.github.io/amazon/index.html
- Yelp Open Dataset: https://www.yelp.com/dataset

---

**æœ€åæ›´æ–°**: 2026-01-05  
**ç‰ˆæœ¬**: v2.0 - å¤šè§†è§’è´å¶æ–¯ç½‘ç»œå»ºæ¨¡
